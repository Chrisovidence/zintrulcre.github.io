
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Convolutional Neural Network Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Deep Learning
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.2.1" data-path="Convolutional Neural Network.html">
            
                <a href="Convolutional Neural Network.html">
            
                    
                    Convolutional Neural Network
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Convolutional Neural Network</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="convolutional-neural-network">Convolutional Neural Network</h1>
<h2 id="convolutional-neural-network">Convolutional Neural Network</h2>
<ul>
<li>input: $ n * n &#x200B;$</li>
<li>filter: $ m * m &#x200B;$<ul>
<li>cross-correlation<ul>
<li>no flipping</li>
<li>used in deep learning</li>
</ul>
</li>
<li>convolution<ul>
<li>flipping</li>
<li>double mirroring</li>
<li>used in mathematics</li>
</ul>
</li>
</ul>
</li>
<li>output: $ (n - m + 1) * (n - m + 1) $</li>
</ul>
<h3 id="filter">filter</h3>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th style="text-align:left"></th>
</tr>
</thead>
<tbody>
<tr>
<td>$ \omega 1 $</td>
<td>$ \omega 2 $</td>
<td style="text-align:left">$ \omega 3 $</td>
</tr>
<tr>
<td>$ \omega 4 $</td>
<td>$ \omega 5 $</td>
<td style="text-align:left">$ \omega 6 $</td>
</tr>
<tr>
<td>$ \omega 7 $</td>
<td>$ \omega 8$</td>
<td style="text-align:left">$ \omega 9$</td>
</tr>
</tbody>
</table>
<h3 id="padding&#xFF08;&#x586B;&#x5145;&#xFF09;">Padding&#xFF08;&#x586B;&#x5145;&#xFF09;</h3>
<ul>
<li>input: $ n * n &#x200B;$</li>
<li>padding: $ p &#x200B;$</li>
<li>filter: $ f * f $<ul>
<li>m is odd</li>
</ul>
</li>
<li>output: $ (n + 2p - f + 1) * (n + 2p - f + 1) $</li>
</ul>
<h4 id="valid-padding">Valid Padding</h4>
<p>no padding</p>
<h4 id="same-padding">Same Padding</h4>
<p>the output size is the same as the input size after padding</p>
<ul>
<li><p>$ n = n + 2p - m + 1$</p>
</li>
<li><p>$ p = \frac{m - 1}{2} $</p>
</li>
</ul>
<h3 id="stride&#xFF08;&#x6B65;&#x957F;&#xFF09;">Stride&#xFF08;&#x6B65;&#x957F;&#xFF09;</h3>
<ul>
<li>input: $ n * n &#x200B;$</li>
<li>padding: $ p &#x200B;$</li>
<li>stride: s</li>
<li>filter: $ f * f $<ul>
<li>m is odd</li>
</ul>
</li>
<li>output: $ \left \lfloor \frac{(n + 2p - m)}{s} + 1 \right \rfloor * \left \lfloor  \frac{(n + 2p - m)}{s} / s + 1 \right \rfloor &#x200B;$<ul>
<li>round down</li>
<li>floor of output</li>
</ul>
</li>
</ul>
<h3 id="convolutions-over-volumes">Convolutions over volumes</h3>
<p>channels: different color detectors</p>
<ul>
<li>input: $ h_i <em> w_i </em> c &#x200B;$<ul>
<li>h: height</li>
<li>w: weight</li>
<li>c: channel / depth</li>
</ul>
</li>
<li>padding: $ p &#x200B;$</li>
<li>stride: s</li>
<li>filter: $ h_f <em> w_f </em> c &#x200B;$<ul>
<li>h: height</li>
<li>w: weight</li>
<li>c: channel / depth</li>
</ul>
</li>
<li>output: $ \left \lfloor \frac{(n + 2p - f)}{s} + 1 \right \rfloor <em> \left \lfloor  \frac{(n + 2p - f)}{s} / s + 1 \right \rfloor </em> n_f&#x200B;$<ul>
<li>$ n_f &#x200B;$: number of filters<ul>
<li>detect different features</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="layer">Layer</h2>
<ul>
<li>Convolution (Conv)</li>
<li>Pooling (POOL)</li>
<li>Fully Connected (FC)</li>
</ul>
<h3 id="convolution-layer-conv">Convolution Layer (CONV)</h3>
<pre><code class="lang-mermaid">graph LR
input --&gt; filter1
input --&gt; filter2
filter1 --&gt;|add bias1, activate|output1
filter2 --&gt;|add bias2, activate|output2
output1 --&gt;|stack| output
output2 --&gt;|stack| output

input_layer --&gt;filter
filter --&gt;|add bias, activate|different_output
different_output --&gt;|stack|cnn_layer
</code></pre>
<h4 id="hyperparameters">Hyperparameters</h4>
<ul>
<li><p>input: $ n ^{[i-1]} <em>{h} * n ^{[i-1]}</em>{w} * n_c^{[i-1]} $</p>
</li>
<li><p>filter: $ f^{[i]} <em> f^{[i]} </em> n_c^{[i-1]} $</p>
</li>
<li><p>padding: $ p^{[i]} * p^{[i]} &#x200B;$</p>
</li>
<li><p>Stride: $ s^{[i]} * s^{[i]} &#x200B;$</p>
</li>
<li><p>output: $ n ^{[i]} <em>{h} * n ^{[i]}</em>{w} * n_c^{[i]} &#x200B;$</p>
<ul>
<li>number of filters: $ n_c^{[i]} $<ul>
<li>bias: $ n_c^{[i]} &#x200B;$</li>
</ul>
</li>
<li>$n ^{[i]}<em>h = \left \lfloor \frac{(n ^{[i-1]} </em>{h} + 2p^{[i]} - f{[i]})}{s^{[i]}} + 1 \right \rfloor &#x200B;$</li>
<li>$ n ^{[i]}<em>w = \left \lfloor \frac{(n ^{[i-1]} </em>{w} + 2p^{[i]} - f{[i]})}{s^{[i]}} + 1 \right \rfloor &#x200B;$</li>
<li>$ n_c^{[i]} $</li>
</ul>
</li>
</ul>
<h3 id="pooling-layer-pool">Pooling Layer (POOL)</h3>
<ul>
<li>static computation</li>
<li>no backpropagation</li>
</ul>
<h4 id="categories">Categories</h4>
<ul>
<li><p>Max Pooling</p>
<ul>
<li>max operation: keep the max number</li>
</ul>
</li>
<li><p>Average Pooling</p>
<ul>
<li>average operation: compute the average</li>
</ul>
</li>
</ul>
<h4 id="hyperparameters">Hyperparameters</h4>
<ul>
<li>filter: $ f^{[i]} <em> f^{[i]} </em> n_c^{[i-1]} $<ul>
<li>usually 2, 3</li>
</ul>
</li>
<li>Stride: $ s^{[i]} * s^{[i]} &#x200B;$<ul>
<li>usually 2</li>
</ul>
</li>
<li>padding: $ p^{[i]} * p^{[i]} $<ul>
<li>usually 0</li>
</ul>
</li>
</ul>
<h3 id="fully-connected-fl">Fully Connected (FL)</h3>
<pre><code class="lang-mermaid">graph LR
input --&gt; CONV1
CONV1 --&gt; POOL1
POOL1 --&gt; CONV2
CONV2 --&gt; POOL2
POOL2 --&gt;|vectorisation|FC3
FC3 --&gt; FC4
FC4 --&gt; softmax
</code></pre>
<h2 id="case">Case</h2>
<h3 id="classic-networks">Classic Networks</h3>
<h4 id="lenet-5">LeNet-5</h4>
<pre><code class="lang-mermaid">graph LR
input --&gt; Conv1
Conv1 --&gt; AvgPool1
AvgPool1 --&gt; Conv2
Conv2 --&gt; AvgPool2
AvgPool2 --&gt;|vectorisation|FC3
FC3 --&gt; FC4
FC4 --&gt; softmax
</code></pre>
<ul>
<li>approximately 60 thousand parameters</li>
<li>activation after pooling</li>
</ul>
<h4 id="alexnet">AlexNet</h4>
<pre><code class="lang-mermaid">graph LR
input --&gt; Conv1
Conv1 --&gt; MaxPool1
MaxPool1 --&gt; Conv2
Conv2 --&gt; MaxPool2
MaxPool2 --&gt; Conv3
Conv3 --&gt; MaxPool3
MaxPool3 --&gt; Conv4
Conv4 --&gt; MaxPool4
MaxPool4 --&gt;|vectorisation|FC1
FC1 --&gt; FC2
FC2 --&gt; softmax
</code></pre>
<ul>
<li>approximately 60 million parameters</li>
<li>relu activation</li>
</ul>
<h4 id="vgg-16">VGG-16</h4>
<h5 id="process">Process</h5>
<ul>
<li>input: 224 <em> 224 </em> 3 --&gt; Conv64 (<em> 2): 224 </em>224 * 64</li>
<li>--&gt; MaxPool: 112 <em> 112 </em> 64</li>
<li>--&gt; Conv128 (<em> 2): 112 </em>112 * 128</li>
<li>--&gt; MaxPool: 56 <em> 56 </em> 128</li>
<li>--&gt; Conv256 (<em> 3): 56 </em> 56 * 256</li>
<li>--&gt; MaxPool: 28 <em> 28 </em> 256</li>
<li>--&gt; Conv512 (<em> 3): 28 </em> 28 * 512</li>
<li>--&gt; MaxPool: 14 <em> 14 </em> 512</li>
<li>--&gt; Conv512 (<em> 3): 14 </em> 14 * 512</li>
<li>--&gt; MaxPool: 7 <em> 7 </em> 512</li>
<li>--&gt; FC: 4096</li>
<li>--&gt; FC: 4096</li>
<li>--&gt; Softmax: 1000</li>
</ul>
<h5 id="pros">Pros</h5>
<ul>
<li>the rate of shrinking images and increasing channels is systematic</li>
</ul>
<h3 id="residual-network">Residual Network</h3>
<h4 id="residual-block">Residual Block</h4>
<h5 id="plain-network">Plain Network</h5>
<ul>
<li>&quot;main path&quot;</li>
<li>$ a^{[l]} $ -&gt; activation -&gt; $ a^{[l + 1]} $ -&gt; activation -&gt; $ a^{[l + 2]} $ -&gt; ...</li>
</ul>
<h5 id="residual-network">Residual Network</h5>
<ul>
<li>&quot;short cut&quot; / &quot;skip connection&quot;</li>
<li>$ a^{[l + 2]}  = g( z^{[l + 2]} + a^{[l]} )$</li>
</ul>
<h3 id="inception">Inception</h3>
<h4 id="1--1-convolution">1 * 1 Convolution</h4>
<ul>
<li>traverse all positions with a 1 * 1 filter</li>
<li>shrink the channel when large<ul>
<li>from n_c to n_f</li>
</ul>
</li>
<li>save computation</li>
<li>learn more the complex function of your network</li>
<li>as bottleneck layer</li>
</ul>
<pre><code class="lang-mermaid">graph LR
CONV1_28*28*192--&gt;|bottleneck layer 1*1 16|CONV2_28*28*16
CONV2_28*28*16--&gt;|filter 5*5 32|CONV3_28*28*32
</code></pre>
<h4 id="inception-block">Inception Block</h4>
<ul>
<li>automatically choose filter size<ul>
<li>size of filters</li>
<li>number of filters</li>
</ul>
</li>
<li>automatically choose filter type (CONV or POOL)</li>
</ul>
<h4 id="inception-module">Inception Module</h4>
<pre><code class="lang-mermaid">graph LR
Previous --&gt; |1*1 64|CONV1
Previous --&gt; |1*1 96|CONV2
CONV2 --&gt;  |3*3 128|CONV3
Previous --&gt; |1*1 16|CONV4
CONV4 --&gt;  |5*5 32|CONV5
Previous --&gt; |3*3 192|MAXPOOL
MAXPOOL --&gt; |1*1 32|CONV6
CONV1 --&gt; |Channel Concat|Activation
CONV3 --&gt; |Channel Concat|Activation
CONV5 --&gt; |Channel Concat|Activation
CONV6 --&gt; |Channel Concat|Activation
</code></pre>
<h4 id="incepution-network">Incepution Network</h4>
<pre><code class="lang-mermaid">graph LR
Previous --&gt; InceptionModule1
InceptionModule1 --&gt; InceptionModule2
InceptionModule2 --&gt; ...
... --&gt; InceptionModulen
InceptionModulen --&gt; output
</code></pre>
<h3 id="transfer-learning">Transfer Learning</h3>
<ul>
<li>pre-training/pre-initialize low-level features</li>
<li>fine tuning / retrain</li>
</ul>
<h4 id="retrain">retrain</h4>
<ul>
<li>just retrain the weights of the last layer</li>
<li>retrain all the layers if you have enough data</li>
</ul>
<h4 id="usage">Usage</h4>
<ul>
<li>low level features from the previous could be helpful for the current</li>
<li>tasks have the same type of input</li>
<li>have <ul>
<li>more data for the the problem transfer from</li>
<li>less data for the problem transfer to</li>
</ul>
</li>
</ul>
<h3 id="data-augmentation">Data Augmentation</h3>
<h4 id="common-method">Common Method</h4>
<ul>
<li>Mirroring</li>
<li>Random Cropping</li>
<li>Rotation</li>
<li>Shearing</li>
<li>Local Warping</li>
</ul>
<h4 id="color-shifting">Color Shifting</h4>
<ul>
<li>adjust R, G, B </li>
<li>PCA color augmentation</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Convolutional Neural Network","level":"1.2.1","depth":2,"previous":{"title":"Deep Learning","level":"1.2","depth":1,"ref":"","articles":[{"title":"Convolutional Neural Network","level":"1.2.1","depth":2,"path":"Deep Learning/Convolutional Neural Network.md","ref":"./Deep Learning/Convolutional Neural Network.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Deep Learning/Convolutional Neural Network.md","mtime":"2019-02-19T01:46:18.131Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-03-17T00:24:59.288Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

