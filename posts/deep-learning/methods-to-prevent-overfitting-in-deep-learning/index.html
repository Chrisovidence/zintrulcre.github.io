<!DOCTYPE html>
<html lang="en-us">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Zhengyu Chen">
    <meta name="description" content="http://zintrulcre.vip">
    <meta name="keywords" content="ZintrulCre">
    
    <meta property="og:site_name" content="ZinBlog">
    <meta property="og:title" content="
  Methods to Prevent Overfitting in Deep Learning - ZinBlog
">
    <meta property="og:description" content="">
    <meta property="og:type" content="website">
    <meta property="og:url" content="http://zintrulcre.vip/posts/deep-learning/methods-to-prevent-overfitting-in-deep-learning/">
    <meta property="og:image" content="http://zintrulcre.vip">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="http://zintrulcre.vip/posts/deep-learning/methods-to-prevent-overfitting-in-deep-learning/">
    <meta name="twitter:image" content="http://zintrulcre.vip">

    <base href="http://zintrulcre.vip">
    <title>
  Methods to Prevent Overfitting in Deep Learning - ZinBlog
</title>

    <link rel="canonical" href="http://zintrulcre.vip/posts/deep-learning/methods-to-prevent-overfitting-in-deep-learning/">
    
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
    
    <link  rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700">
    <link rel="stylesheet" href="//cdn.rawgit.com/necolas/normalize.css/master/normalize.css">
    <link rel="stylesheet" href="http://zintrulcre.vip/css/style.min.css">

    

    

    <link rel="icon" type="image/png" href="http://zintrulcre.vip/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://zintrulcre.vip/images/favicon-16x16.png" sizes="16x16">

    

    <meta name="generator" content="Hugo 0.53" />
  </head>

  <body class="">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">ZinBlog</a>
    <input type="checkbox" id="menu-control"/>
    <label class="menu-mobile  float-right " for="menu-control">
      <span class="btn-mobile  float-right ">&#9776;</span>
      <ul class="navigation-list">
        
          
            <li class="navigation-item  align-center ">
              <a class="navigation-link" href="http://zintrulcre.vip/posts/">Posts</a>
            </li>
          
            <li class="navigation-item  align-center ">
              <a class="navigation-link" href="http://zintrulcre.vip/categories/">Categories</a>
            </li>
          
            <li class="navigation-item  align-center ">
              <a class="navigation-link" href="http://zintrulcre.vip/ZinNote/">Notebooks</a>
            </li>
          
            <li class="navigation-item  align-center ">
              <a class="navigation-link" href="http://zintrulcre.vip/projects/">Projects</a>
            </li>
          
            <li class="navigation-item  align-center ">
              <a class="navigation-link" href="http://zintrulcre.vip/ZinMark/">Bookmarks</a>
            </li>
          
            <li class="navigation-item  align-center ">
              <a class="navigation-link" href="http://zintrulcre.vip/about">About</a>
            </li>
          
        
        
      </ul>
    </label>
  </section>
</nav>


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/contrib/auto-render.min.js"></script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>

      <div class="content">
        
  <section class="container post">
  <article>
    <header>
      <h1 class="title">Methods to Prevent Overfitting in Deep Learning</h1>
      <h2 class="date">March 20, 2019</h2>

      
    </header>

    

<h1 id="methods-to-prevent-overfitting-in-deep-learning">Methods to Prevent Overfitting in Deep Learning</h1>

<h2 id="overfitting">Overfitting</h2>

<p>Overfitting refers to that when a model fits the training data well but cannot predict the test data correctly, we may say that the model lacks the ability of generalization. It is important to figure out how it happens, and how we can prevent overfitting from the very beginning.</p>

<h2 id="detect-overfitting">Detect Overfitting</h2>

<p>The simplest way to detect overfitting is to split the dataset into two parts: the training set for training the model, and the test set for testing the accuracy of the model on a dataset that it has never seen before. Of course, we will also partition part of the training set to be the validation set for fine-tuning hyper-parameters. Note that it is necessary to shuffle all the data before splitting.</p>

<p>Through this split, we check the performance of the model to gain insight on how the training process goes, and detect overfitting.</p>

<p>During training, we may see the process:</p>

<p><img src="https://raw.githubusercontent.com/ZintrulCre/zintrulcre.github.io/master/posts/deep-learning/0.png"></p>

<p>The accuracy on the training set has reached a very high ratio, but the accuracy on the validation set still remains not high enough, or even a little bit low.</p>

<p>If we plot the accuracy and loss of the training set and the validation set into one figure, we will see:</p>

<p><img src="https://raw.githubusercontent.com/ZintrulCre/zintrulcre.github.io/master/posts/deep-learning/1.png"></p>

<p>It is obvious that the accuracy of the validation data is much  lower than that of the training data.</p>

<p>Although overfitting is frustrating, there are plenty of methods to prevent it from happening.</p>

<h2 id="prevent-overfitting">Prevent Overfitting</h2>

<p>Here are some practical methods to prevent overfitting during training deep neural networks:</p>

<h3 id="1-regularization">1. Regularization</h3>

<p>Regularization is the most-used method to prevent overfitting in Machine Learning. It constrains the learning of the model by adding a regularization term. Typical regularization is to explicitly add regularization terms in the objective function, e.g. L1 and L2 regularization terms.</p>

<p>In deep learning, there are two commonly-used regularization methods: <strong>Batch Normalization</strong> and <strong>Dropout</strong>.</p>

<h4 id="batch-normalization">Batch Normalization</h4>

<!-- Batch Gradient Descent -->

<!-- In deep learning, since using the whole training set to do train the model, i.e. Batch Gradient Descent, requires a large amount of memory and a very long time, we divide the dataset to mini-batches to train the model. Batch Normalization is calculated based on mini-batch.

Mini-Batch Gradient Descent is a method to group scattered data. The term "mini-batch" refers to a small group of data, that is the number of samples per round of optimization. It divides the data into mini-batches and updates the parameters mini-batch by mini-batch. The data in one mini-batch together determine the direction of the gradient descent, which reduces the randomness when updating parameters using Stochastic Gradient Descent. In the meanwhile, the number of samples in a mini-batch is much smaller than that in an entire dataset, so the amount of calculation has dropped a lot compared with using Batch Gradient Descent. -->

<p>As the training progresses, the parameters in the deep neural network are constantly updated. On the one hand, parameters are changing slightly during the training. Due to the activation functions in each layer, these slight changes are amplified as the number of layers deepens, and the input distribution of each layer changes; on the other hand, with the change of parameters, former layers need to adapt to these distribution changes, which makes it more difficult to train the model. These are called Internal Covariate Shift.</p>

<p>Batch Normalization is proposed to solve these two problems. We perform normalization on each layer separately, making the features of each layer have a mean of 0 and a variance of 1, which lets the value of each layer propagate in the effective range. we can also add a linear transformation operation, so that the data can restore the ability of expression.</p>

<p>The intuition of Batch Normalization is not to prevent over-fitting or prevent the gradient from vanishing or exploding but to increase the robustness by normalizing the parameter. This constraint also improves the structural rationality of the system, which brings a series of improvements, e.g. accelerate convergence, prevent over-fitting, etc.</p>

<h4 id="dropout">Dropout</h4>

<p>When we are training the model, we can set a probability P for eliminating a node in the deep neural network. For each node, there is a probability of (1-P) for keeping it and a probability of P for dropping it. Then we perform forward-propagation and backpropagation-propagation on this much-diminished deep neural network.</p>

<p>At each training step of a mini-batch dataset, the process of dropout creates a different deep neural network by randomly removing some units regarding the probability P. The process of dropout is similar to use ensemble learning on many different deep neural networks, each trained with a separate mini-batch dataset but share some context in the process of training.</p>

<p>In ensemble learning, since each classifier has been trained separately, it has learned different aspects of the dataset and their mistakes are different. Combining them helps to produce a more accurate classifier, which is less prone to overfitting. We can view dropout as a form of ensemble learning, and this is why it can prevent overfitting.</p>

<h3 id="2-data-augmentation">2. Data Augmentation</h3>

<p>In Deep Learning, collecting data is an effective way to enhance the training but also a tedious and intricate process. In fact, for the majority of image recognition problems, we cannot get as much data as we expect. In order to obtain more data, <strong>data augmentation</strong> techniques is a very efficient method to improve the result.</p>

<p>For Convolutional Neural Networks, some common image augmentation techniques are listed:</p>

<ul>
<li>mirroring/flipping (on vertical or horizontal axis)</li>
<li>rotating</li>
<li>cropping</li>
<li>scaling</li>
<li>warping</li>
<li>color shifting</li>
<li>adding noise</li>
</ul>

<p>There are two ways to do data augmentation: <strong>Offline Augmentation</strong> and <strong>Online Augmentation</strong>.</p>

<h4 id="offline-augmentation">Offline Augmentation</h4>

<p><strong>Offline Augmentation</strong> is to perform all augmentations in advance, before training, and save all the augmented data in memory. In fact, it will increase, or multiple, the size of the dataset. This method fits small datasets well.</p>

<h4 id="online-augmentation">Online Augmentation</h4>

<p>Another option, <strong>Online Augmentation</strong>, is to perform these augmentations on a mini-batch dataset right before they are fed to the model. This method is more suitable for large datasets because we do not have enough memory for staging all the augmented data when its scale is too enormous, so what we do is to perform mini-batch augmentation before feeding the current batch of data into the model.</p>

<h3 id="3-early-stopping">3. Early Stopping</h3>

<p>Early Stopping is a trade-off between training epochs and validation accuracy. At the end of each epoch, compare current validation accuracy of this epoch with the best validation accuracy. If the accuracy on the validation set decreases or does not reach the best one for more than 10 consecutive epochs, we stop the training, and we think the accuracy is no longer improved.</p>

<h3 id="4-simplify-the-model">4. Simplify The Model</h3>

<p>If we have done all the methods above to prevent overfitting but the performance is still bad, we may consider simplifying our model. The model may be too complicated for our dataset to fit and we can try to reduce the complexity of the model in some ways, e.g. reduce the number of layers, remove some neurons, etc.</p>

  </article>

  <br/>

  
      <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "zintrulcre" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  
  
</section>

      </div>
      
        
<script>renderMathInElement(document.body);</script>
      
    </main>

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-132809676-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


  <script src="http://zintrulcre.vip/js/app.js"></script>
  
  </body>
</html>
